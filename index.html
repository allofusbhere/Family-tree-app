<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SwipeTree rc1c (domproxy)</title>
  <link rel="stylesheet" href="style.css" />

  <!-- Robust selector helper injected BEFORE core so older code won't crash -->
  <script>
    (function(){
      function resolve(sel){
        if(!sel) return null;
        // If no #/. given, assume it's an ID
        if (/^[A-Za-z0-9_-]+$/.test(sel)) {
          return document.getElementById(sel) || document.querySelector("#"+sel);
        }
        try { return document.querySelector(sel); } catch(e){ return null; }
      }
      function makeProxy(sel){
        return {
          addEventListener: function(type, handler, opts){
            function tryBind(attempts){
              var el = resolve(sel);
              if (el) { el.addEventListener(type, handler, opts||false); return; }
              if ((attempts||0) > 60) return; // ~1s max (60*16ms)
              requestAnimationFrame(function(){ tryBind((attempts||0)+1); });
            }
            tryBind(0);
          },
          // minimal surface to avoid crashes if accessed
          setAttribute: function(){ /* no-op until element exists */ },
          get style(){ var el=resolve(sel); return el ? el.style : {}; }
        };
      }
      window.$ = function(sel){
        var el = resolve(sel);
        return el || makeProxy(sel);
      };
    })();
  </script>
</head>
<body>
  <button id="backBtn">← Back</button>
  <h1>SwipeTree</h1>
  <div>
    <input id="idInput" type="text" placeholder="Enter ID (e.g., 100000)" />
    <button id="startBtn">Start</button>
  </div>
  <div id="stage">
    <img id="anchorImg" src="" alt="Anchor" />
    <div id="displayName"></div>
    <div id="displayId"></div>
  </div>
  <p class="help">
    Swipe: ◀ siblings • ▶ spouse • ▲ parents • ▼ children<br />
    Long-press on anchor to edit name (SoftEdit). Tap tiles to navigate.
  </p>

  <!-- Load your full app logic -->
  <script src="script.v132.js"></script>
  <!-- Glue enhancements (swipes/autostart/image fallback/NBSP cleanup) -->
  <script src="script.js"></script>
</body>
</html>