(function(){function e(e){return document.querySelector(e)}function t(e,t,n,o){const r="string"==typeof e?document.querySelector(e):e;r&&r.addEventListener(t,n,o||!1)}const n={anchorId:null,history:[],longPressTimer:null,longPressMs:520,namesCache:{}};function o(){const e=location.hash.match(/id=([0-9.]+)/);if(e)return e[1];const t=new URLSearchParams(location.search);return t.get("id")||null}function r(e){n.anchorId&&n.history.push(n.anchorId);try{history.replaceState({},"","#id="+e)}catch{}}const a=window.BUILD_TAG||"v7",i="https://allofusbhere.github.io/family-tree-images/",c=".jpg";function s(e){return i+e+c+"?v="+encodeURIComponent(a)}function l(e){return parseInt(String(e).split(".")[0],10)}function d(e){return String(e).includes(".1")}function u(e){return d(e)?String(e).replace(".1",""):String(e)+".1"}function h(e){let t=l(e),n=0;for(;t%10==0&&0!==t;)t=Math.floor(t/10),n++;return n}function p(e){return Math.pow(10,h(e))}function g(e){return Math.pow(10,Math.max(0,h(e)-1))}function f(e){e=l(e);const t=p(e),n=Math.floor(e/t)%10;return e-n*t}function m(e){e=l(e);const t=p(e),n=Math.floor(e/t)%10,o=e-n*t,r=[];for(let a=1;a<=9;a++){const i=o+a*t;i!==e&&r.push(String(i))}return r}function v(e){e=l(e);const t=g(e),n=[];for(let o=1;o<=9;o++)n.push(String(e+o*t));return n}function y(t){n.anchorId=String(t);const o=e("#anchorId");o&&(o.textContent=n.anchorId);const r=e("#anchorImg");r&&(r.src=s(n.anchorId),r.removeAttribute("hidden"))}function b(){const t=e("#grid");t&&(t.innerHTML="")}function S(t){const n=e("#gridOverlay");n&&(e("#overlayTitle").textContent=t||"",n.classList.remove("hidden"))}function w(){const t=e("#gridOverlay");t&&t.classList.add("hidden")}function E(t,n){const o=document.createElement("div");o.className="tile",o.dataset.id=t,o.innerHTML=`<div class="tid">${t}</div><img alt="person"/><div class="name"></div>`;const r=o.querySelector("img");r.src=s(t),r.addEventListener("error",(()=>o.remove()),{once:!0}),o.addEventListener("click",(()=>{(function(t){r(String(t)),y(String(t))})(t),w()})),n.appendChild(o)}function q(e,t){b(),S(e);const n=document.querySelector("#grid");n&&t.forEach((e=>E(e,n)))}function L(){(function(e){r(String(e)),y(String(e))})(u(n.anchorId))}function O(){q("Siblings",m(n.anchorId))}function P(){q("Children",v(n.anchorId))}function x(){const e=f(n.anchorId),t=[];e&&0!==e&&(t.push(String(e)),t.push(u(String(e)))),q("Parents",t)}function k(n){if(!n)return;let o=0,r=0,a=!1;n.addEventListener("touchstart",(e=>{const t=e.changedTouches[0];o=t.clientX,r=t.clientY,a=!0}),{passive:!0}),n.addEventListener("touchend",(e=>{if(!a)return;a=!1;const t=e.changedTouches[0],n=t.clientX-o,r=t.clientY-r;Math.abs(n)<30&&Math.abs(r)<30||(Math.abs(n)>Math.abs(r)?n>0?function(){d(n.anchorId)?(function(e){r(String(e)),y(String(e))})(u(n.anchorId)):q("Spouse",[u(n.anchorId)])}():O():r>0?P():x())}),{passive:!0})}document.addEventListener("DOMContentLoaded",(function(){t("#closeOverlay","click",w),t("#backBtn","click",(()=>{const t=e("#gridOverlay");if(t&&!t.classList.contains("hidden"))return void w();const o=n.history.pop();o&&y(o)})),t("#startBtn","click",(()=>{const e=prompt("Enter starting ID",n.anchorId||"100000");e&&(r(String(e)),y(String(e)))})),k(e("#anchorCard"));const t=o()||"100000";n.anchorId=String(t),y(n.anchorId)}))})();