:root {
  --header-h: 48px;
  --footer-h: 28px;
  --pad: 12px;
}
* { box-sizing: border-box; }
html, body { height: 100%; }
body {
  margin: 0;
  font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  background:#fafafa; color:#222;
  overflow: hidden; /* keep everything to one screen */
}
header {
  height: var(--header-h);
  display:flex; align-items:center; justify-content:space-between;
  padding: 0 var(--pad);
  background:#fff; border-bottom:1px solid #eee;
}
h1 { font-size:16px; margin:0; }
#status { font-size:12px; opacity:0.8; }

main {
  height: calc(100vh - var(--header-h) - var(--footer-h));
  padding: var(--pad);
  display: grid;
  grid-template-rows: auto 1fr;
  gap: var(--pad);
}

/* Anchor row: image + controls side-by-side on wide screens, stacked on small */
#anchorArea {
  display: grid;
  grid-template-columns: minmax(180px, 36vh) 1fr;
  gap: var(--pad);
  align-items: center;
  background:#fff; border:1px solid #eee; border-radius:12px;
  padding: var(--pad);
}
.img-wrap {
  width: 100%;
  /* Image box scales with viewport; clamp to keep it reasonable */
  height: clamp(180px, 36vh, 360px);
  display:flex; align-items:center; justify-content:center;
  background:#f2f2f2; border-radius:12px; overflow:hidden;
}
#anchorImg { width:100%; height:100%; object-fit: contain; }
.right { display:flex; flex-direction: column; gap: 8px; }
.id-text { font-weight:600; font-size: clamp(14px, 2.2vh, 18px); }
.meta { font-size: clamp(12px, 1.8vh, 14px); color:#555; }

#controls { display:flex; flex-wrap: wrap; gap:8px; }
#controls button {
  padding:10px 14px; border-radius:10px; border:1px solid #ddd; background:#fff; cursor:pointer;
  font-size: clamp(12px, 1.8vh, 14px);
}
#controls button:active { transform: translateY(1px); }

/* Results grid fills remaining space, no outer scrolling; grid itself scrolls if needed */
.grid {
  background:#fff; border:1px solid #eee; border-radius:12px; padding: 8px;
  display:grid; grid-template-columns: repeat(3, 1fr); gap:10px;
  overflow: auto; /* internal scroll only if necessary */
}
.card { background:#fff; border:1px solid #eee; border-radius:12px; padding:6px; text-align:center; }
.card img {
  width:100%;
  height: clamp(120px, 20vh, 220px);
  object-fit:contain; background:#f7f7f7; border-radius:10px;
}
.card .caption { font-size: clamp(11px, 1.6vh, 13px); margin-top:4px; color:#444; word-break:break-all; }

footer {
  height: var(--footer-h);
  display:flex; align-items:center;
  padding: 0 var(--pad);
}
footer details { width: 100%; }
footer summary { font-size: 12px; cursor: pointer; }
#debugLog { font-family: ui-monospace, SFMono-Regular, Menlo, Consolas, monospace; font-size:12px; white-space:pre-wrap; background:#fff; border:1px solid #eee; border-radius:8px; padding:8px; max-height: 30vh; overflow:auto; }

/* Stack on narrow screens */
@media (max-width: 700px) {
  #anchorArea { grid-template-columns: 1fr; }
}